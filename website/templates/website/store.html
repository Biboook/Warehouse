{% extends 'website/main.html' %}
{% load static %}

{% block title %}Store{% endblock %}

{% block body %}
    <div class="block">
        {% if store %}
            {% for s in store %}
                <div class="container">
                    <button id="show-popup">Store name: {{ s.name }}</button>
                    <div class="popup popup-hidden">
                        <h2>Products</h2>
                        <div class="container">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th>Item Name</th>
                                    <th>Quantity</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% if products %}
                                    {% for p in products %}
                                        <!-- check if product belongs to the store -->
                                        {% if s.id is p.store.id %}
                                            <tr>
                                                <td>{{ p.name }}</td>
                                                <td>{{ p.numbers }}</td>
                                            </tr>
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                                </tbody>
                            </table>
                        </div>
                        <button id="close-popup">Close</button>
                    </div>
                </div>
            {% endfor %}
            </div>
        {% else %}
            <div class="block">
                <h4 class="mt-3 mb-3 text-center">Store is empty</h4>
            </div>
        {% endif %}
    <head>
        <link rel="stylesheet" href="{% static 'website/css/userpage.css' %}">
        <link rel="stylesheet" href="{% static 'website/js/userpage.js' %}">
    </head>
    <script>
        const popup = document.querySelector(".popup");
        const closePopupButtons = document.querySelectorAll("#close-popup");

        closePopupButtons.forEach(closePopupButton => {
            closePopupButton.addEventListener("click", () => {
                closePopupButton.parentNode.style.display = "none";
            });
        });

        const showPopupButtons = document.querySelectorAll("#show-popup");

        showPopupButtons.forEach(showPopupButton => {
            const popup = showPopupButton.nextElementSibling;
            showPopupButton.addEventListener("click", () => {
                popup.style.display = "block";
            });
        });


    </script>
{% endblock %}
